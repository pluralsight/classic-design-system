sudo: false

language: node_js

cache: yarn

# always test things that aren't pushes (like PRs)
# never test tags or pushes to non-master branches (wait for PR)
if: type != push OR (tag IS blank AND branch = master)

install:
  - yarn --ignore-engines

jobs:
  include:
    - stage: validate
      name: Lint Commits
      script:
        - yarn add @commitlint/travis-cli --ignore-engines --ignore-workspace-root-check
        - commitlint-travis
    - name: Lint Files
      script: yarn lint:no-fail
    # - name: Danger
    #   script:
    #     - yarn danger ci
    - stage: test
      name: Unit Test
      script:
        - yarn run lerna run prepublish
        - yarn test
